Sorry about the spaghetti code, will comment the code some time later.
Will get rid of using namespace std later
