This is in python, translate to C if efficiency is going to matter a lot, this project is likely to fail because it is too amibitious 
