This is in python, translate to C if efficiency is going to matter a lot, this project is likely to fail as it is too amibitious 
